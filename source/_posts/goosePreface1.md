title: goose自己写的搜索引擎-序言1
date: 2014-08-22 10:32:38
categories: 
- 技术
- 搜索引擎
tags:
- goose
- golang
- 搜索引擎
---
#什么是goose
goose是使用golang开发检索框架,目标是打造一个简单方便使用的小型检索系统.
期望解决百万量级doc数量的检索问题.

#为什么叫goose
由于是使用golang开发的search engine,一开始想到就是用gose这个单词,但是其没有什么含义,突然发现往中间加多一个字母o,就形成了一个有意义的单词 ***goose*** ,另外想到很多牛X的项目(或语言)都以动物名字来命名,所以觉得 ***goose*** 这个名字挺好.

#goose的特性(设计原则)

在开发goose的之前,设想了需要解决的问题以及最后的形态,goose有着以下的特性,在设计其子模块的时候也都是以以下原则为前提.

##百万量级
目标解决问题是百万量级的文档的检索问题.百万量级做全网网页检索肯定是不够的,全网网页检索需要一套非常庞大的检索系统,但是在实际的工程中,有很多时候我们不需要这么复杂,而是需要一个轻便的,可以快速搭建的检索服务,因此百万量级能够满足很多普通的工程需求.

##只是一个搜索框架
一个搜索系统可能会包含爬虫,离线数据处理,数据存储,检索模块等功能模块.检索模块在设计上又可以分为检索框架以及检索策略.而goose只是其中的检索框架,也就是说仅仅只有goose还不能成为一个完成的服务,他还需要相应的检索策略实现.
通常情况下,框架是比较容易复用的,而策略相对不容易复用,因为策略需要根据实际的产品需求决定,而且还有可能混杂着产品业务逻辑,因此使用goose需要基于goose做二次开发,实现相应的检索策略,才能形成完整的服务.

有时候会需要快速搭建一个检索服务,检索策略不需要过多的定制,采用通用的策略即可.而且根本就不想进行编码工作,最好是拿到就可以使用.针对这样的场景,我基于goose进行了二次开发,实现了一套通用检索策略,取名为[cse](https://github.com/getwe/cse)意思是Common Search Engine,可以实现零编码,纯配置的通用搜索引擎.


##单机单进程
goose是一个单机单进程服务,启动一个进程的情况下可以完成检索系统所需的功能,**索引建库**,**实时索引更新**以及**检索**均在一个服务中完成.
由于目标是百万量级的文档数的检索问题,即使是现在的一台普通PC的硬件配置都可以解决问题,因此完全不考虑实现成一个分布式的检索系统.单机服务使得整个系统更简单,更容易开发以及维护升级.
关于单机服务系统的性能,稳定性以及容灾性问题,在实际工作中,我曾经是这样解决的:
* 多机房多机器重复部署
* 实时索引同时更新到全部机器
* 需要全量切换索引的时候同时切换
* 上游请求检索服务的时候做负载均衡

##实时索引
goose设计为支持实时索引,在提供检索服务的时候,可以实时往其写入文档,并在**短时间**内被检索出来.

##socket网络服务
goose设计对外提供的索引更新和检索服务均为socket服务,这样跟其它服务耦合比较低.另外goose跟其它服务通信的协议完全由策略决定,采用json,messagepack或者protocolbuf等任何一种协议对goose来说都无差别,都是一段二进制字节数据.



